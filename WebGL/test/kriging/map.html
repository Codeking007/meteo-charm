<html>
<head>
    <meta http-equiv="content-type" content="text/html; charset=windows-1252">
</head>
<body>
<canvas width="100%" height="100%" id="mycanvas"></canvas>

<script type="text/javascript" src="kriging.js"></script>
<script type="text/javascript" src="pollution.js"></script>
<script type="text/javascript" src="nyc.js"></script>
<script src="../image.js"></script>
<script type="text/javascript">
    MeteoImage.load("at0_100.png").then((meteo) => {
        let polygons = [[
            [-180, -180, 180, 180, -180],
            [-90, 90, 90, -90, -90]
        ]];
        let longitude = [];
        let latitude = [];
        let response = [];
        for (let y = meteo.lat[0]; y <= meteo.lat[1]; y += meteo.lat[2]*20) {
            for (let x = meteo.lon[0]; x <= meteo.lon[1]; x += meteo.lon[2]*20) {
                longitude.push(x);
                latitude.push(y);
                let dataRate = meteo.data[(((y - meteo.lat[0]) / meteo.lat[2]) * meteo.width + (x - meteo.lon[0]) / meteo.lon[2]) * 4]/255;
                let datum = dataRate * (meteo.minAndMax[0][1] - meteo.minAndMax[0][0]) + meteo.minAndMax[0][0];
                response.push(datum);
            }
        }
        let longrange = [meteo.lon[0], meteo.lon[1]];
        let latrange = [meteo.lat[0], meteo.lat[1]];


        let x = new kriging("mycanvas", 1,meteo);
        x.krig(longitude, latitude, response, polygons);
        x.map([longrange.mean(), latrange.mean()], 1);
    });


</script>

</body>
</html>